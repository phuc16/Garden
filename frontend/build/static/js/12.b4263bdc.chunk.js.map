{"version":3,"sources":["app/environment-factors/Light.js"],"names":["Light","props","data","labels","datasets","label","backgroundColor","borderColor","borderWidth","fill","options","scales","yAxes","ticks","beginAtZero","legend","display","elements","point","radius","state","allLight","todayLight","lastData","today","Date","date","getFullYear","getMonth","getDate","nextDate","axios","get","process","then","res","temp","i","length","push","setState","x","console","log","nearestData","todayDataChart","todayColumn","allDataChart","allColumn","this","slice","replace","sumLight","timeMax","timeMin","changeData","showChart","map","o","value","indexOf","Math","max","min","products","round","StatColumn","dataField","text","sort","className","aria-label","to","aria-current","width","height","id","x1","y1","x2","y2","offset","stopColor","floor","abs","bootstrap4","keyField","columns","defaultActiveKey","eventKey","title","pagination","paginationFactory","sizePerPage","Component"],"mappings":"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","file":"static/js/12.b4263bdc.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { CircularProgressbarWithChildren } from 'react-circular-progressbar';\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport { Tabs, Tab } from 'react-bootstrap';\r\nimport { Line } from 'react-chartjs-2';\r\nimport { Link } from 'react-router-dom';\r\nimport paginationFactory from 'react-bootstrap-table2-paginator';\r\nimport axios from 'axios';\r\nimport './factor.css'\r\n\r\nclass Light extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      allLight: [],\r\n      todayLight : [],\r\n      lastData: 0,\r\n    };\r\n  }\r\n  async componentDidMount(){\r\n    var today = new Date();\r\n    var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n    var nextDate = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+(today.getDate() + 1);\r\n    // console.log(nextDate)\r\n\r\n    await axios.get(process.env.REACT_APP_SERVER + `/data`)\r\n    .then(res => {\r\n      let temp = []\r\n      for (let i = 0; i<res.data.length; i++){\r\n        if (res.data[i]['category'] == 'Light'){\r\n          temp.push(res.data[i])\r\n        }\r\n      }\r\n      this.setState({allLight: temp})\r\n    })\r\n\r\n    await axios.get(process.env.REACT_APP_SERVER + `/data/last`)\r\n    .then(res => {\r\n      var x = 0\r\n      for (let i = 0; i < res.data.length; i++){\r\n        if (res.data[i]['category'] == 'Light'){\r\n          x = res.data[i]['value']\r\n        }\r\n      }\r\n      console.log(x)\r\n      this.setState({lastData: x})\r\n    })\r\n\r\n    await axios.get(process.env.REACT_APP_SERVER + `/data/search?idGarden=1&startDay=${date}&endDay=${nextDate}`)\r\n    .then(res => {\r\n      let temp = []\r\n      for (let i = 0; i<res.data.length; i++){\r\n        if (res.data[i]['category'] == 'Light'){\r\n         temp.push(res.data[i])\r\n        }\r\n      }\r\n      this.setState({todayLight: temp})\r\n    })\r\n\r\n    await axios.get(process.env.REACT_APP_SERVER +  `/data/before-last`)\r\n    .then(res => {\r\n      let x = res.data\r\n      this.setState({nearestData: x['Light']})\r\n    })\r\n  }\r\n\r\n  data = {\r\n    labels: [],\r\n    datasets: [{\r\n      label: 'Today Light Intensity',\r\n      data: [],\r\n      backgroundColor: [\r\n        'rgba(255, 99, 132, 0.2)',\r\n        'rgba(54, 162, 235, 0.2)',\r\n        'rgba(255, 206, 86, 0.2)',\r\n        'rgba(75, 192, 192, 0.2)',\r\n        'rgba(153, 102, 255, 0.2)',\r\n        'rgba(255, 159, 64, 0.2)'\r\n      ],\r\n      borderColor: [\r\n        'rgba(255,99,132,1)',\r\n        'rgba(54, 162, 235, 1)',\r\n        'rgba(255, 206, 86, 1)',\r\n        'rgba(75, 192, 192, 1)',\r\n        'rgba(153, 102, 255, 1)',\r\n        'rgba(255, 159, 64, 1)'\r\n      ],\r\n      borderWidth: 1,\r\n      fill: true\r\n    }]\r\n  };\r\n\r\n  options = {\r\n      scales: {\r\n        yAxes: [{\r\n          ticks: {\r\n            beginAtZero: true\r\n          }\r\n        }]\r\n      },\r\n      legend: {\r\n        display: true\r\n      },\r\n      elements: {\r\n        point: {\r\n          radius: 0\r\n        }\r\n      }\r\n\r\n  };\r\n\r\n  showChart(){\r\n    var todayDataChart = []\r\n    var todayColumn = []\r\n    var allDataChart = []\r\n    var allColumn = []\r\n    \r\n    for (let i = 0; i< this.state.todayLight.length; i++){\r\n      todayDataChart.push(this.state.todayLight[i]['value'])\r\n      todayColumn.push(this.state.todayLight[i]['time'].slice(11, this.state.todayLight[i]['time'].length).replace('.000Z', ''))\r\n    }\r\n\r\n    for (let i = 0; i< this.state.todayLight.length; i++){\r\n      allDataChart.push(this.state.todayLight[i]['value'])\r\n      allColumn.push(this.state.todayLight[i]['time'].slice(0, 11).replace('T', ''))\r\n    }\r\n    this.data.labels = todayColumn\r\n    this.data.datasets[0].data = todayDataChart\r\n    console.log(todayColumn)\r\n  }\r\n\r\n  render () {\r\n    console.log('render')\r\n    var sumLight = 0\r\n    var todayLight = [];\r\n    var timeMax = ''\r\n    var timeMin = ''\r\n    var today = new Date();\r\n    var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();\r\n    var changeData = [this.state.lastData - this.state.nearestData]\r\n    this.showChart()\r\n\r\n\r\n    for (let i = 0; i < this.state.todayLight.length; i++){\r\n      sumLight += this.state.todayLight[i]['value']\r\n    }\r\n\r\n    if (this.state.todayLight.length > 0){\r\n      var temp = []\r\n      temp.push(...this.state.todayLight.map(o => o.value))\r\n      timeMax = this.state.todayLight[temp.indexOf(Math.max(...this.state.todayLight.map(o => o.value)))]['time']\r\n      timeMax = timeMax.replace('T', ', ').replace('.000Z', '')\r\n      timeMin = this.state.todayLight[temp.indexOf(Math.min(...this.state.todayLight.map(o => o.value)))]['time']\r\n      timeMin = timeMin.replace('T', ', ').replace('.000Z', '')\r\n    }\r\n\r\n    const products = [\r\n      {'id': 'Max', 'light': this.state.todayLight.length >0 ?Math.max(...this.state.todayLight.map(o => o.value)) : 'No data', 'time': timeMax},\r\n      {'id': 'Min', 'light': this.state.todayLight.length >0 ?Math.min(...this.state.todayLight.map(o => o.value)) : 'No data', 'time': timeMin},\r\n      {'id': 'Avarage', 'light': this.state.todayLight.length>0? Math.round((sumLight/this.state.todayLight.length)*100)/100 : 'No data', 'time': date}\r\n    ];\r\n\r\n\r\n    const columns = [{\r\n      dataField: 'id',\r\n      text: '', \r\n      sort: true\r\n    }, {\r\n      dataField: 'light',\r\n      text: 'Light',\r\n      sort: true\r\n    }, {\r\n      dataField: 'time',\r\n      text: 'Time',\r\n      sort: true\r\n    }\r\n    ];\r\n\r\n    const StatColumn = [{\r\n      dataField: 'id',\r\n      text: 'ID', \r\n      sort: true\r\n    }, {\r\n      dataField: 'value',\r\n      text: 'Value',\r\n      sort: true\r\n    }, {\r\n      dataField: 'time',\r\n      text: 'Time',\r\n      sort: true\r\n    }\r\n    ]\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"page-header\">\r\n          <h3 className=\"page-title\">\r\n            Light Intensity\r\n          </h3>\r\n          <nav aria-label=\"breadcrumb\">\r\n            <ol className=\"breadcrumb\">\r\n            <li className=\"breadcrumb-item\"><Link to='/dashboard'>Device Control Center</Link></li>\r\n            <li className=\"breadcrumb-item active\" aria-current=\"page\">Light</li>\r\n            </ol>\r\n          </nav>\r\n        </div>\r\n        <div className=\"row\"> \r\n          <div className=\"col-xl-3 col-lg-6 col-sm-6 grid-margin stretch-card\">\r\n            <div className=\"card\">\r\n              <div className=\"card-body text-center\">\r\n                <h5 className=\"mb-2 text-dark font-weight-normal\">Light intensity</h5>\r\n                <h2 className=\"mb-4 text-dark font-weight-bold\">{this.state.lastData}</h2>\r\n                  <div className=\"px-4 d-flex align-items-center\">\r\n                    <svg width=\"0\" height=\"0\">\r\n                      <defs>\r\n                        <linearGradient id=\"progress-followers\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\r\n                          <stop offset=\"0%\" stopColor=\"#f5515f\"/>\r\n                          <stop offset=\"100%\" stopColor=\"#9f041b\"/>\r\n                        </linearGradient>\r\n                      </defs>\r\n                    </svg>\r\n                    <CircularProgressbarWithChildren className=\"progress-followers\"\r\n                    value={this.state.lastData/10}>\r\n                      <div>\r\n                        <i className=\"mdi mdi-weather-sunny icon-md absolute-center text-dark\"></i>\r\n                      </div>\r\n                    </CircularProgressbarWithChildren>\r\n                  </div>  \r\n                  <p className=\"mt-4 mb-0\">{changeData >= 0 ? 'Increased since' : 'Decreased since' } last time</p>\r\n                  <h3 className=\"mb-0 font-weight-bold mt-2 text-dark\">{Math.floor(Math.abs(changeData)/this.state.nearestData*100)} %</h3>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-xl-9 col-lg-6 col-sm-6 grid-margin stretch-card\">\r\n          <div className=\"card\">\r\n          <div className=\"card-body text-center\">\r\n          <h5 className=\"mb-2 text-dark font-weight-normal\">Light Intensity Overview</h5>\r\n            <BootstrapTable bootstrap4 keyField='id' data={ products } columns={ columns } />\r\n            </div>\r\n          </div>\r\n          </div>\r\n        </div>\r\n        <div className='row'>\r\n        <div className=\"col-md-12\">\r\n              <div className=\"justify-content-between align-items-center tab-transparent\">\r\n        <Tabs defaultActiveKey=\"chart\" id=\"uncontrolled-tab-example\" className=\"mb-3\">\r\n          <Tab eventKey=\"chart\" title=\"Chart\">\r\n          <div className=\"card\">\r\n                <div className=\"card-body\">\r\n                    <h4 className=\"card-title\">Light Intensity Chart</h4>\r\n                    <Line data={this.data} options={this.options} />\r\n                </div>\r\n            </div>\r\n          </Tab>\r\n          <Tab eventKey=\"today\" title=\"Today\">\r\n          <div className=\"card\">\r\n          <div className=\"card-body text-center\">\r\n          <h5 className=\"mb-2 text-dark font-weight-normal\">Light Intensity Stats Today</h5>\r\n            <BootstrapTable bootstrap4 keyField='id' data={ this.state.todayLight } columns={ StatColumn } \r\n            pagination={paginationFactory({ sizePerPage: 5 })}/>\r\n            </div>\r\n          </div>\r\n\r\n          </Tab>\r\n          <Tab eventKey=\"data\" title=\"Data\">\r\n            <div className=\"card\">\r\n              <div className=\"card-body text-center\">\r\n                <h5 className=\"mb-2 text-dark font-weight-normal\">Light Intensity Stats</h5>\r\n                <BootstrapTable\r\n                  bootstrap4 \r\n                  keyField='id' \r\n                  data={ this.state.allLight } \r\n                  columns={ StatColumn } \r\n                  pagination={paginationFactory({ sizePerPage: 5 })}/>\r\n              </div>\r\n            </div>\r\n          </Tab>\r\n        </Tabs>\r\n        </div>\r\n        </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Light;"],"sourceRoot":""}