{"version":3,"sources":["app/control-scheduler/schedule.js"],"names":["TimeSetting","props","state","reload","scheduled","settingDevice","axios","get","process","then","res","temp","data","setState","console","log","this","handleDeleteSchedule","e","target","value","delete","deviceInSchedule","catch","err","handleTimeStart","index","parseInt","className","deviceInSetting","handleTimeEnd","handleSetSchedule","device_id","post","id_device","time_start","time_end","status","slice","window","location","replace","i","length","push","setting","style","backgroundColor","border","color","onClick","type","onChange","step","defaultActiveKey","id","eventKey","title","keyField","columns","dataField","text","Component"],"mappings":"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","file":"static/js/8.d5751dca.chunk.js","sourcesContent":["import { Tabs, Tab, Button } from \"react-bootstrap\"\r\nimport BootstrapTable from \"react-bootstrap-table-next\"\r\nimport React, { Component } from 'react';\r\nimport './schedule.css'\r\n// import TimePicker from 'react-bootstrap-time-picker';\r\nimport axios from 'axios'\r\n\r\n\r\n\r\nclass TimeSetting extends Component {\r\n    \r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        reload: false,\r\n        scheduled: [], \r\n        settingDevice: [],\r\n        // time_start: [],\r\n        // time_end: []\r\n      };\r\n    }\r\n\r\n    componentDidMount() {\r\n      axios.get(process.env.REACT_APP_SERVER + `/schedule?startDay=2000-01-01&endDay=2023-01-01`)\r\n        .then(res => {\r\n          const temp = res.data; \r\n          this.setState({ scheduled : temp });\r\n          console.log(this.state.scheduled)\r\n        })\r\n\r\n      axios.get(process.env.REACT_APP_SERVER + `/device`)\r\n        .then(res => {\r\n          const temp = res.data; \r\n          this.setState({ settingDevice : temp });\r\n        })\r\n    }\r\n\r\n    \r\n\r\n    render(){\r\n      console.log(this.state.scheduled)\r\n      const handleDeleteSchedule = (e) => {\r\n        let index = e.target.value\r\n        axios.delete(process.env.REACT_APP_SERVER + `/schedule/${deviceInSchedule[e.target.value]['id']}`)\r\n        .then(res => {\r\n          // this.setState((prevState) => {\r\n          //   console.log(prevState)\r\n          //   return {scheduled: [\r\n          //     ...prevState.scheduled.slice(0, index), \r\n          //     ...prevState.scheduled.slice(index+1)\r\n          //   ]}\r\n          // })\r\n        axios.get(process.env.REACT_APP_SERVER + `/schedule?startDay=2000-01-01&endDay=2023-01-01`)\r\n        .then(res => {\r\n          const temp = res.data; \r\n          this.setState({ scheduled : temp });\r\n        })\r\n\r\n\r\n          \r\n        })\r\n        .catch(err =>{\r\n          console.log(err)\r\n        })\r\n      }\r\n\r\n      const handleTimeStart = e => {\r\n        let index = parseInt(e.target.className)\r\n        console.log(typeof(e.target.value))\r\n        deviceInSetting[index]['time_start'] = e.target.value\r\n      }\r\n\r\n      const handleTimeEnd = e => {\r\n        let index = parseInt(e.target.className)\r\n        deviceInSetting[index]['time_end'] = e.target.value\r\n      }\r\n\r\n      const handleSetSchedule = (e) => {\r\n        let index = e.target.value\r\n        let device_id = deviceInSetting[index]['id']\r\n\r\n        axios.post(process.env.REACT_APP_SERVER + `/schedule`, {\r\n          id_device: device_id,\r\n          time_start: deviceInSetting[index]['time_start'],\r\n          time_end: deviceInSetting[index]['time_end'],\r\n          status: 0\r\n        })\r\n        .then(res => {\r\n          this.setState({ scheduled : [\r\n            ...this.state.scheduled.slice(0, index), \r\n            ...this.state.scheduled.slice(index+1)\r\n          ]})\r\n          window.location.replace('/control-scheduler/schedule')\r\n        })\r\n        \r\n      }\r\n\r\n      const deviceInSchedule = [];\r\n      const deviceInSetting = []\r\n\r\n      for (let i = 0; i < this.state.scheduled.length ; i++){\r\n        deviceInSchedule.push({...this.state.scheduled[i],  \r\n        time_start: this.state.scheduled[i]['time_start'].replace('T', ', ').replace('.000Z', '') ,\r\n        time_end: this.state.scheduled[i]['time_end'] == 'null' ? 'Chưa xác định' : this.state.scheduled[i]['time_end'].replace('T', ', ').replace('.000Z', '') ,\r\n        status: this.state.scheduled[i]['status'] == 0 ? 'Chưa thực thi' \r\n        : (this.state.scheduled[i]['status'] == 1? 'Đang thực hiện' : \r\n        ((this.state.scheduled[i]['status'] == 2? 'Hoàn thành' : \r\n        (this.state.scheduled[i]['status'] == 3? 'Time Out' : 'Task LTT')))), \r\n        setting:  this.state.scheduled[i]['status'] != 2 ?<Button style={{backgroundColor: 'white', border: '1px solid red', color: 'red'}} value={i} onClick={handleDeleteSchedule}>Delete</Button>: '' })\r\n      }\r\n\r\n      for (let i = 0; i < this.state.settingDevice.length ; i++){\r\n          deviceInSetting.push({...this.state.settingDevice[i], \r\n          time_start: <input type=\"datetime-local\" onChange={handleTimeStart} className={i} step={1}></input>, \r\n          time_end: <input type=\"datetime-local\" onChange={handleTimeEnd}  className={i} step={1} ></input>,\r\n          setting:  <Button value={i} onClick={handleSetSchedule}>Set</Button> }) \r\n      }\r\n\r\n      // console.log(this.state.scheduled[0])\r\n    const columns = [{\r\n        dataField: 'id',\r\n        text: 'ID'\r\n      }, {\r\n        dataField: 'id_device',\r\n        text: 'Device ID'\r\n      }, \r\n      {\r\n        dataField: 'time_start',\r\n        text: 'Time Start'\r\n      },\r\n      {\r\n        dataField: 'time_end',\r\n        text: 'Time End'\r\n      },\r\n      {\r\n        dataField: 'status',\r\n        text: 'Status'\r\n      },\r\n      {\r\n        dataField: 'setting',\r\n        text: 'Setting'\r\n      }\r\n      ];\r\n    \r\n    const columns2 = [{\r\n        dataField: 'id',\r\n        text: 'ID'\r\n      }, \r\n      {\r\n        dataField: 'name',\r\n        text: 'Device Name'\r\n      },\r\n      {\r\n        dataField: 'time_start',\r\n        text: 'Time Start'\r\n      },\r\n      {\r\n        dataField: 'time_end',\r\n        text: 'Time End'\r\n      },\r\n      {\r\n        dataField: 'setting',\r\n        text: 'Setting'\r\n      }\r\n      ];\r\n\r\n        return(\r\n            <div>\r\n                <div className='row'>\r\n                    <div className=\"col-md-12\">\r\n                        <div className=\"justify-content-between align-items-center tab-transparent\">\r\n                            <Tabs defaultActiveKey=\"table\" id=\"uncontrolled-tab-example\" className=\"mb-3\">\r\n                            <Tab eventKey=\"table\" title=\"Schedule\">\r\n                            <div className=\"card\">\r\n                            <div className=\"card-body text-center\">\r\n                            <h5 className=\"mb-2 text-dark font-weight-normal\">Device Schedule</h5>\r\n                                <BootstrapTable keyField='id' data={ deviceInSchedule } columns={ columns } />\r\n                                </div>\r\n                            </div>\r\n                            </Tab>\r\n                            <Tab eventKey=\"setting\" title=\"Setting\" className=\"setting\">\r\n                            <div className=\"card\">\r\n                            <div className=\"card-body text-center\">\r\n                            <h5 className=\"mb-2 text-dark font-weight-normal\">Schedule Setting</h5>\r\n                                <BootstrapTable keyField='id' data={ deviceInSetting } columns={ columns2 } />\r\n                                </div>\r\n                            </div>\r\n\r\n                            </Tab>\r\n                            </Tabs>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default TimeSetting;"],"sourceRoot":""}